# RSA加密原理
## 一.生成RSA密钥
选择两个大素数$p和q$    
计算$n=p*q$  
计算$\phi(n)=\phi(p*q)=(p-1)(q-1)$  $\phi(n)$表示:在小于等于n的正整数之中，与n构成互质关系的数的个数  
选择满足以下条件的公开指数$e\in\{1,2,...,\phi(n)-1\}$  
$$
    gcd(e,\phi(n))=1
$$
即$(e*d) \% \phi(n)=1$  
计算满足以下条件的私钥$d$   
$$
    d*e \equiv 1 \bmod \phi(n)   
$$
$$
    d=pow(e,-1,\phi(n))   
$$  
条件$gcd(e,\phi(n))=1$保证$e$的逆元存在模$\phi(n)$,因此，私钥$d$始终存在
![alt rsa](rsa-1.png)
下面举一个完整的例子    
1.找出质数p 、q 

    p = 3  
    q = 11
 
2、计算公共模数 n：

    n = p * q = 3 * 11 = 33
    n = 33

3、计算欧拉函数 φ(n)：

    φ(n) = (p-1)(q-1) = 2 * 10 = 20
    φ(n) = 20

4、计算公钥 e：

    1 < e < φ(n)
    1 < e < 20
    e 的取值范围为： { 3, 7, 9, 11, 13, 17, 19 }

为了方便测试，我们取最小的值 e =3，3 和 φ(n) = 20 互为质数，满足条件。

5、计算私钥 d：

    e * d % φ(n) = 1
    3 * d % 20 = 1   
计算出 d = 7    


6、公钥加密：   

$$
    公式：C=M^e \bmod(n)  
$$   
$$
C=pow(M,e,n)
$$
随便拿一个数字，这里方便演示 取$M = 2$  
$C =2^3\%33=8$  
" M = 2 " 经过RSA加密后变成了 " C = 8 "

7、私钥解密：   

$$
M ＝C^d \bmod(n)
$$
$$
M=pow(C,d,n)
$$
C = 8   
d = 7   
n = 33  
计算：
$M =8^7 \% 33$  
解得： M = 2


